<!DOCTYPE html>
<html>
  <head>
    <title>successResponse</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
    <meta name="apple-mobile-web-app-capable" content="yes"/>
    <link href="resources/css/jquery-ui-themes.css" type="text/css" rel="stylesheet"/>
    <link href="resources/css/axure_rp_page.css" type="text/css" rel="stylesheet"/>
    <link href="data/styles.css" type="text/css" rel="stylesheet"/>
    <link href="files/successresponse_2/styles.css" type="text/css" rel="stylesheet"/>
    <script src="resources/scripts/jquery-1.7.1.min.js"></script>
    <script src="resources/scripts/jquery-ui-1.8.10.custom.min.js"></script>
    <script src="resources/scripts/prototypePre.js"></script>
    <script src="data/document.js"></script>
    <script src="resources/scripts/prototypePost.js"></script>
    <script src="files/successresponse_2/data.js"></script>
    <script type="text/javascript">
      $axure.utils.getTransparentGifPath = function() { return 'resources/images/transparent.gif'; };
      $axure.utils.getOtherPath = function() { return 'resources/Other.html'; };
      $axure.utils.getReloadPath = function() { return 'resources/reload.html'; };
    </script>
  </head>
  <body>
    <div id="base" class="">

      <!-- Unnamed (Vertical Line) -->
      <div id="u734" class="ax_default arrow">
        <img id="u734_img" class="img " src="images/successresponse_2/u734.png"/>
        <!-- Unnamed () -->
        <div id="u735" class="text" style="display:none; visibility: hidden">
          <p><span></span></p>
        </div>
      </div>

      <!-- Unnamed (Rectangle) -->
      <div id="u736" class="ax_default flow_shape">
        <div id="u736_div" class=""></div>
        <!-- Unnamed () -->
        <div id="u737" class="text">
          <p><span>&#149; headerField Ciphertext</span></p><p><span>&#149; user name</span></p><p><span>&#149; token1</span></p>
        </div>
      </div>

      <!-- Unnamed (Connector) -->
      <div id="u738" class="ax_default connector">
        <img id="u738_seg0" class="img " src="images/successresponse_2/u738_seg0.png" alt="u738_seg0"/>
        <img id="u738_seg1" class="img " src="images/registration_workflow/u36_seg1.png" alt="u738_seg1"/>
        <img id="u738_seg2" class="img " src="images/registration_workflow/u36_seg2.png" alt="u738_seg2"/>
        <!-- Unnamed () -->
        <div id="u739" class="text" style="display:none; visibility: hidden">
          <p><span></span></p>
        </div>
      </div>

      <!-- Unnamed (Rectangle) -->
      <div id="u740" class="ax_default flow_shape">
        <div id="u740_div" class=""></div>
        <!-- Unnamed () -->
        <div id="u741" class="text">
          <p style="text-align:center;"><span style="font-family:'ArialMT', 'Arial';font-weight:400;">Retrieve and check </span><span style="font-family:'Arial-BoldMT', 'Arial Bold', 'Arial';font-weight:700;">token2</span><span style="font-family:'ArialMT', 'Arial';font-weight:400;"></span></p><p><span style="font-family:'ArialMT', 'Arial';font-weight:400;"><br></span></p><p style="text-align:left;"><span style="font-family:'ArialMT', 'Arial';font-weight:400;">&#149; headerField Ciphertext</span></p><p><span style="font-family:'ArialMT', 'Arial';font-weight:400;">&#149; token1</span></p><p><span style="font-family:'ArialMT', 'Arial';font-weight:400;"><br></span></p><p><span style="font-family:'ArialMT', 'Arial';font-weight:400;">The actual </span><span style="font-family:'Arial-BoldMT', 'Arial Bold', 'Arial';font-weight:700;">token2</span><span style="font-family:'ArialMT', 'Arial';font-weight:400;"> in the dB will be matched against the supplied one by the </span><span style="font-family:'Arial-BoldMT', 'Arial Bold', 'Arial';font-weight:700;">headerFiled Ciphertext</span><span style="font-family:'ArialMT', 'Arial';font-weight:400;">: </span></p><p><span style="font-family:'ArialMT', 'Arial';font-weight:400;"><br></span></p><p><span style="font-family:'ArialMT', 'Arial';font-weight:400;">- the actual user in the session will provide its user name and token1, which were retrieved by the current deviceId held in session, once the user has been authenticated. Now we have to find the second part of the tokens by looking it up by the first part. If we find the token1, then we will ask for its pair, the token2. Finally, we will match this token2 with the value in the </span><span style="font-family:'Arial-BoldMT', 'Arial Bold', 'Arial';font-weight:700;">headerFiled Ciphertext. Since the token pairs will be regenerated by every login and logout, every valid token pair is ultimately tied to one particular deviceId with logged_in state, which relates to the user name held in session, and vice-verse.</span></p>
        </div>
      </div>

      <!-- Unnamed (Connector) -->
      <div id="u742" class="ax_default connector">
        <img id="u742_seg0" class="img " src="images/successresponse_2/u742_seg0.png" alt="u742_seg0"/>
        <img id="u742_seg1" class="img " src="images/sessioncreation_1/u572_seg1.png" alt="u742_seg1"/>
        <img id="u742_seg2" class="img " src="images/x-token/u284_seg2.png" alt="u742_seg2"/>
        <!-- Unnamed () -->
        <div id="u743" class="text" style="display:none; visibility: hidden">
          <p><span></span></p>
        </div>
      </div>

      <!-- Unnamed (Database) -->
      <div id="u744" class="ax_default flow_shape">
        <img id="u744_img" class="img " src="images/registration/u152.png"/>
        <!-- Unnamed () -->
        <div id="u745" class="text">
          <p><span>dB</span></p>
        </div>
      </div>

      <!-- Unnamed (Connector) -->
      <div id="u746" class="ax_default connector">
        <img id="u746_seg0" class="img " src="images/successresponse_2/u746_seg0.png" alt="u746_seg0"/>
        <img id="u746_seg1" class="img " src="images/registration_workflow/u36_seg1.png" alt="u746_seg1"/>
        <img id="u746_seg2" class="img " src="images/registration_workflow/u36_seg2.png" alt="u746_seg2"/>
        <!-- Unnamed () -->
        <div id="u747" class="text" style="display:none; visibility: hidden">
          <p><span></span></p>
        </div>
      </div>

      <!-- Unnamed (Diamond) -->
      <div id="u748" class="ax_default flow_shape">
        <img id="u748_img" class="img " src="images/successresponse_2/u748.png"/>
        <!-- Unnamed () -->
        <div id="u749" class="text">
          <p><span style="font-family:'ArialMT', 'Arial';font-weight:400;">Is there any token2, which belongs to the token1, that matches the value in the </span><span style="font-family:'Arial-BoldMT', 'Arial Bold', 'Arial';font-weight:700;">headerFiled Ciphertext?</span><span style="font-family:'ArialMT', 'Arial';font-weight:400;">&nbsp; </span></p>
        </div>
      </div>

      <!-- Unnamed (Connector) -->
      <div id="u750" class="ax_default connector">
        <img id="u750_seg0" class="img " src="images/successresponse_2/u750_seg0.png" alt="u750_seg0"/>
        <img id="u750_seg1" class="img " src="images/registration_workflow/u36_seg1.png" alt="u750_seg1"/>
        <img id="u750_seg2" class="img " src="images/registration_workflow/u36_seg2.png" alt="u750_seg2"/>
        <!-- Unnamed () -->
        <div id="u751" class="text" style="display:none; visibility: hidden">
          <p><span></span></p>
        </div>
      </div>

      <!-- Unnamed (Beveled Rectangle) -->
      <div id="u752" class="ax_default flow_shape">
        <img id="u752_img" class="img " src="images/successresponse_2/u752.png"/>
        <!-- Unnamed () -->
        <div id="u753" class="text">
          <p><span>Commit errorResponse</span></p>
        </div>
      </div>

      <!-- Unnamed (Beveled Rectangle) -->
      <div id="u754" class="ax_default flow_shape">
        <img id="u754_img" class="img " src="images/successresponse_2/u752.png"/>
        <!-- Unnamed () -->
        <div id="u755" class="text">
          <p><span>Commit successResponse</span></p>
        </div>
      </div>

      <!-- Unnamed (Connector) -->
      <div id="u756" class="ax_default connector">
        <img id="u756_seg0" class="img " src="images/successresponse_2/u756_seg0.png" alt="u756_seg0"/>
        <img id="u756_seg1" class="img " src="images/registration_workflow/u36_seg1.png" alt="u756_seg1"/>
        <img id="u756_seg2" class="img " src="images/registration_workflow/u36_seg2.png" alt="u756_seg2"/>
        <!-- Unnamed () -->
        <div id="u757" class="text" style="display:none; visibility: hidden">
          <p><span></span></p>
        </div>
      </div>

      <!-- Unnamed (Connector) -->
      <div id="u758" class="ax_default connector">
        <img id="u758_seg0" class="img " src="images/successresponse_2/u758_seg0.png" alt="u758_seg0"/>
        <img id="u758_seg1" class="img " src="images/registration_workflow/u36_seg1.png" alt="u758_seg1"/>
        <img id="u758_seg2" class="img " src="images/registration_workflow/u36_seg2.png" alt="u758_seg2"/>
        <!-- Unnamed () -->
        <div id="u759" class="text" style="display:none; visibility: hidden">
          <p><span></span></p>
        </div>
      </div>

      <!-- Unnamed (Diamond) -->
      <div id="u760" class="ax_default flow_shape">
        <img id="u760_img" class="img " src="images/successresponse_2/u760.png"/>
        <!-- Unnamed () -->
        <div id="u761" class="text">
          <p><span>Is there any user with the given user name held in session?</span></p>
        </div>
      </div>

      <!-- Unnamed (Connector) -->
      <div id="u762" class="ax_default connector">
        <img id="u762_seg0" class="img " src="images/sessioncreation_1/u586_seg0.png" alt="u762_seg0"/>
        <img id="u762_seg1" class="img " src="images/registration_workflow/u36_seg1.png" alt="u762_seg1"/>
        <img id="u762_seg2" class="img " src="images/registration_workflow/u36_seg2.png" alt="u762_seg2"/>
        <!-- Unnamed () -->
        <div id="u763" class="text" style="display:none; visibility: hidden">
          <p><span></span></p>
        </div>
      </div>

      <!-- Unnamed (Beveled Rectangle) -->
      <div id="u764" class="ax_default flow_shape">
        <img id="u764_img" class="img " src="images/successresponse_2/u752.png"/>
        <!-- Unnamed () -->
        <div id="u765" class="text">
          <p><span>Commit errorResponse</span></p>
        </div>
      </div>

      <!-- Unnamed (Connector) -->
      <div id="u766" class="ax_default connector">
        <img id="u766_seg0" class="img " src="images/successresponse_2/u766_seg0.png" alt="u766_seg0"/>
        <img id="u766_seg1" class="img " src="images/registration_workflow/u36_seg1.png" alt="u766_seg1"/>
        <img id="u766_seg2" class="img " src="images/registration_workflow/u36_seg2.png" alt="u766_seg2"/>
        <!-- Unnamed () -->
        <div id="u767" class="text" style="display:none; visibility: hidden">
          <p><span></span></p>
        </div>
      </div>

      <!-- Unnamed (Shape) -->
      <div id="u768" class="ax_default icon">
        <img id="u768_img" class="img " src="images/hmac/u266.png"/>
        <!-- Unnamed () -->
        <div id="u769" class="text" style="display:none; visibility: hidden">
          <p><span></span></p>
        </div>
      </div>

      <!-- Unnamed (Shape) -->
      <div id="u770" class="ax_default icon">
        <img id="u770_img" class="img " src="images/hmac/u266.png"/>
        <!-- Unnamed () -->
        <div id="u771" class="text" style="display:none; visibility: hidden">
          <p><span></span></p>
        </div>
      </div>

      <!-- Unnamed (Shape) -->
      <div id="u772" class="ax_default icon">
        <img id="u772_img" class="img " src="images/voucher/u96.png"/>
        <!-- Unnamed () -->
        <div id="u773" class="text" style="display:none; visibility: hidden">
          <p><span></span></p>
        </div>
      </div>
    </div>
  </body>
</html>
